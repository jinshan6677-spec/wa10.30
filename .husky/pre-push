#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 运行pre-push检查..."

# 运行完整测试套件
echo "🧪 运行完整测试套件..."
npm run test:coverage

if [ $? -ne 0 ]; then
  echo "❌ 测试覆盖率检查失败，请提高测试覆盖率"
  exit 1
fi

# 检查构建是否成功
echo "🏗️ 检查构建..."
npm run build

if [ $? -ne 0 ]; then
  echo "❌ 构建失败，请修复构建错误"
  exit 1
fi

echo "✅ Pre-push检查通过！"
exit 0