#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 运行pre-commit检查..."

# 运行lint检查
echo "📝 运行ESLint..."
npm run lint

if [ $? -ne 0 ]; then
  echo "❌ ESLint检查失败，请修复错误后重试"
  exit 1
fi

# 运行类型检查
echo "🔧 运行TypeScript类型检查..."
npm run type-check

if [ $? -ne 0 ]; then
  echo "❌ TypeScript类型检查失败，请修复错误后重试"
  exit 1
fi

# 运行格式检查
echo "💅 检查代码格式..."
npm run format -- --check

if [ $? -ne 0 ]; then
  echo "❌ 代码格式检查失败，请运行 'npm run format' 修复格式"
  exit 1
fi

# 运行测试
echo "🧪 运行测试..."
npm test

if [ $? -ne 0 ]; then
  echo "❌ 测试失败，请修复测试后重试"
  exit 1
fi

echo "✅ Pre-commit检查通过！"
exit 0